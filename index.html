<!DOCTYPE html>
<html>
  <head>
    <title>Severus Prototype</title>Â 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="css/master.css">
    <link rel="manifest" href="json/manifest.json">
  </head>
  <body>
    <div id='Wrapper' class='wrapper'>
      <header>
        <h1 id="HeaderText">
          <!-- //////////////////////////////////// -->
          <!-- //////// headline goes here //////// -->
          <!-- //////////////////////////////////// -->
        </h1>
        <div class='progressBar-wrapper'>
          <div class='progressBar-bg'>
            <div class='progressBar-bar'></div>
          </div>
        </div> <!--  / .progressBar_wrapper -->
      </header>

      <div id="Card-Wrapper" class='card-wrapper'>
      <!-- //////////////////////////////////// -->
      <!-- //////// content goes here ///////// -->
      <!-- //////////////////////////////////// -->
      </div> <!--  / .content_wrapper -->

      <div class='btn-wrapper'>
        <button id="Btn_Previous" class='btn btn-secondary'>Previous</button>
        <button id="Btn_Next" class='btn btn-primary'>Next</button>
      </div>

    </div> <!--  / #Wrapper -->

  </body>

<!-- Includes  -->


  <script src="js/scripts.js"></script>
  <script src="js/jquery-3.2.1.min.js"></script>
  <script src="js/handlebars-v4.2.0.js"></script>


  <!-- //////////////////////////////// -->
  <!-- //////// card template ///////// -->
  <!-- //////////////////////////////// -->

  <script id="Card-Template" type="text/x-handlebars-template">
    <div class='content-card'>

      <h2>{{question}}</h2>
      <p>{{headline}}</p>

      <ul class="question-list">

        {{#each answers}}
          <li>
            <input type="radio" id="radio_{{answer}}" name="radio" />
            <label for="radio_{{answer}}"><span class="wrap"><span class="bullet"></span></span>{{answer}}</label>
          </li>
        {{/each}}

      </ul>
    </div>
  </script>


  <script type="text/javascript">

    var numCurrentQ;
    var depressionQuestions;
    var questionText;
    var answers;
    var numTotalQ;
    var cardTemplateSource;
    var cardTemplateClean;
    var cardTemplateDirty;



    $(function(){

      ///////////////////////////
      ////// DEPRESSION /////////
      ///////////////////////////

      // set current question number
      numCurrentQ = 0;
      var currentQuestionNum = numCurrentQ + 1;
      // get depression questions data
      depressionQuestions = data.surveys.depression.questions;
      // get current question text
      questionText = depressionQuestions[numCurrentQ].question;
      // get answers for current question
      answers = depressionQuestions[numCurrentQ].answers;
      // get total questions number
      numTotalQ = depressionQuestions.length;

      // update the header
      $('#HeaderText').html("Question "+currentQuestionNum+" of "+ numTotalQ);

      // get the card template structure
      cardTemplateSource = document.getElementById("Card-Template").innerHTML;

      // sprinkle some magic dust on it
      cardTemplateClean = Handlebars.compile(cardTemplateSource);

      // add data to it
      cardTemplateDirty = cardTemplateClean(depressionQuestions[numCurrentQ]);

      // show the people
      $('#Card-Wrapper').html(cardTemplateDirty);

        $('#Btn_Next').click(function(){
          updateScreen(depressionQuestions, numCurrentQ);
        });

      }); // ready


      function updateScreen(depressionQuestions){
      console.log('stop');
        var questionsObj = depressionQuestions;
        if(numCurrentQ == numTotalQ-1){
          numCurrentQ = 0;
        }else{
          numCurrentQ++;
        }


        // get current question text
        var newQuestionText = questionsObj[numCurrentQ].question;
        // get answers for current question
        var newAnswers = questionsObj[numCurrentQ].answers;
        var currentQuestionNum = numCurrentQ + 1;
        // update the header
        $('#HeaderText').html("Question "+currentQuestionNum+" of "+ numTotalQ);

        // add data to it
        var newCardTemplateDirty = cardTemplateClean(depressionQuestions[numCurrentQ]);
        // show the people
        $('#Card-Wrapper').html(newCardTemplateDirty);

      }




  </script>


</html>
